// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model agents {
  id                        String          @id
  name                      String         
  description               String?        
  user_id                   String         
  workspace_id              String?        
  personality               String?        
  instructions              String?        
  agent_type                String?        
  model_provider            String?        
  model_name                String?        
  temperature               Float?         
  max_tokens                Int?           
  top_p                     Float?         
  frequency_penalty         Float?         
  presence_penalty          Float?         
  tools                     String?        
  knowledge_base            String?        
  capabilities              String?        
  status                    String?        
  avatar_url                String?        
  configuration             String?        
  conversation_count        Int?           
  message_count             Int?           
  total_tokens_used         Int?           
  average_response_time     Float?         
  rating_average            Float?         
  rating_count              Int?           
  last_active_at            DateTime?      
  created_at                DateTime?       @default(now())
  updated_at                DateTime?       @default(now())
}

model analytics_alerts {
  id                        Int             @id @default(autoincrement())
  user_id                   Int            
  name                      String         
  description               String?        
  rule_config               String?        
  notification_config       String?        
  status                    String?        
  last_triggered            DateTime?      
  created_at                DateTime?       @default(now())
  updated_at                DateTime?       @default(now())
}

model analytics_dashboards {
  id                        Int             @id @default(autoincrement())
  user_id                   Int            
  name                      String         
  description               String?        
  layout                    String?        
  widgets                   String?        
  is_public                 Boolean?       
  created_at                DateTime?       @default(now())
  updated_at                DateTime?       @default(now())
}

model analytics_events {
  id                        Int             @id @default(autoincrement())
  user_id                   Int?           
  session_id                String?        
  event_type                String         
  event_name                String         
  properties                String?        
  timestamp                 DateTime?       @default(now())
  ip_address                String?        
  user_agent                String?        
  page_url                  String?        
  referrer                  String?        
}

model analytics_exports {
  id                        Int             @id @default(autoincrement())
  user_id                   Int            
  export_type               String         
  query_config              String?        
  format                    String         
  status                    String?        
  file_path                 String?        
  file_size                 Int?           
  created_at                DateTime?       @default(now())
  completed_at              DateTime?      
  expires_at                DateTime?      
}

model analytics_metrics {
  id                        Int             @id @default(autoincrement())
  metric_type               String         
  metric_name               String         
  value                     String         
  dimensions                String?        
  timestamp                 DateTime       
  granularity               String         
  created_at                DateTime?       @default(now())
}

model analytics_reports {
  id                        Int             @id @default(autoincrement())
  user_id                   Int            
  name                      String         
  description               String?        
  query_config              String?        
  schedule_config           String?        
  status                    String?        
  created_at                DateTime?       @default(now())
  updated_at                DateTime?       @default(now())
}

model business_metrics {
  id                        Int             @id @default(autoincrement())
  date                      DateTime       
  period_type               String         
  total_users               Int            
  new_users                 Int            
  active_users              Int            
  churned_users             Int            
  total_sessions            Int            
  avg_session_duration      Float          
  total_page_views          Int            
  bounce_rate               Float          
  workflows_created         Int            
  workflows_executed        Int            
  components_published      Int            
  components_downloaded     Int            
  workspaces_created        Int            
  teams_formed              Int            
  collaborative_sessions    Int            
  total_revenue             Float          
  recurring_revenue         Float          
  marketplace_revenue       Float          
  avg_revenue_per_user      Float          
  error_rate                Float          
  avg_response_time         Float          
  uptime_percentage         Float          
  customer_satisfaction     Float          
  created_at                DateTime       
  updated_at                DateTime       
}

model component_downloads {
  id                        Int             @id @default(autoincrement())
  component_id              Int            
  user_id                   Int            
  version                   String?        
  download_date             DateTime?       @default(now())
  ip_address                String?        
  user_agent                String?        
}

model component_favorites {
  id                        Int             @id @default(autoincrement())
  component_id              Int            
  user_id                   Int            
  created_at                DateTime?       @default(now())}

model component_purchases {
  id                        Int             @id @default(autoincrement())
  component_id              Int            
  user_id                   Int            
  amount                    String         
  currency                  String?        
  payment_method            String?        
  transaction_id            String?        
  status                    String?        
  purchased_at              DateTime?       @default(now())
}

model component_ratings {
  id                        Int             @id @default(autoincrement())
  component_id              Int            
  user_id                   Int            
  rating                    Int            
  review                    String?        
  helpful_count             Int?           
  created_at                DateTime?       @default(now())
  updated_at                DateTime?       @default(now())}

model component_versions {
  id                        Int             @id @default(autoincrement())
  component_id              Int            
  version                   String         
  content                   String?        
  changelog                 String?        
  file_path                 String?        
  file_size                 Int?           
  downloads_count           Int?           
  is_latest                 Boolean?       
  created_at                DateTime?       @default(now())}

model conversations {
  id                        String          @id
  user_id                   String         
  agent_id                  String?        
  workspace_id              String?        
  title                     String?        
  status                    String?        
  message_count             Int?           
  total_tokens_used         Int?           
  context                   String?        
  settings                  String?        
  last_message_at           DateTime?      
  created_at                DateTime?       @default(now())
  updated_at                DateTime?       @default(now())}

model custom_reports {
  id                        Int             @id @default(autoincrement())
  user_id                   Int            
  workspace_id              Int?           
  name                      String         
  description               String?        
  category                  String?        
  query_config              String         
  visualization_config      String?        
  filters                   String?        
  is_scheduled              Boolean        
  schedule_config           String?        
  last_run_at               DateTime?      
  next_run_at               DateTime?      
  is_public                 Boolean        
  shared_with               String?        
  cached_data               String?        
  cache_expires_at          DateTime?      
  status                    String         
  created_at                DateTime       
  updated_at                DateTime       
}

model email_verification_tokens {
  id                        String          @id
  token                     String         
  user_id                   String         
  expires_at                DateTime       
  is_used                   Boolean?       
  created_at                DateTime?       @default(now())

model execution_metrics {
  id                        Int             @id @default(autoincrement())
  workflow_execution_id     Int            
  node_execution_id         Int?           
  metric_type               String         
  metric_name               String         
  value_numeric             Int?           
  value_float               String?        
  value_text                String?        
  value_json                String?        
  context                   String?        
  tags                      String?        
  measured_at               DateTime?       @default(now())
  created_at                DateTime?       @default(now())
}

model execution_queue {
  id                        Int             @id @default(autoincrement())
  queue_id                  String         
  workflow_execution_id     Int            
  user_id                   Int            
  priority                  Int?           
  scheduled_at              DateTime?      
  started_at                DateTime?      
  completed_at              DateTime?      
  status                    String?        
  worker_id                 String?        
  max_execution_time        Int?           
  retry_count               Int?           
  max_retries               Int?           
  metadata                  String?        
  created_at                DateTime?       @default(now())
  updated_at                DateTime?       @default(now())}

model files {
  id                        Int             @id @default(autoincrement())
  filename                  String         
  original_filename         String         
  content_type              String         
  file_size                 Int            
  file_hash                 String         
  storage_path              String         
  tags                      String?        
  description               String?        
  is_public                 String         
  created_at                DateTime        @default(now())
  updated_at                DateTime        @default(now())}

model marketplace_components {
  id                        Int             @id @default(autoincrement())
  name                      String         
  description               String?        
  category                  String         
  component_type            String         
  tags                      String?        
  price                     String?        
  is_free                   Boolean?       
  author_id                 Int            
  version                   String         
  content                   String?        
  metadata                  String?        
  downloads_count           Int?           
  rating_average            String?        
  rating_count              Int?           
  is_featured               Boolean?       
  is_approved               Boolean?       
  status                    String?        
  created_at                DateTime?       @default(now())
  updated_at                DateTime?       @default(now())
}

model messages {
  id                        String          @id
  conversation_id           String         
  role                      String         
  content                   String         
  attachments               String?        
  model_used                String?        
  model_provider            String?        
  tokens_used               Int?           
  processing_time_ms        Int?           
  temperature               Float?         
  max_tokens                Int?           
  status                    String?        
  error_message             String?        
  rating                    Int?           
  feedback                  String?        
  created_at                DateTime?       @default(now())
  updated_at                DateTime?       @default(now())}

model node_categories {
  id                        String          @id
  name                      String         
  description               String?        
  icon                      String?        
  color                     String?        
  parent_id                 String?        
  sort_order                Int?           
  is_active                 Boolean?       
  created_at                DateTime?       @default(now())}

model node_executions {
  id                        Int             @id @default(autoincrement())
  execution_id              String         
  workflow_execution_id     Int            
  node_id                   Int            
  node_key                  String         
  node_type                 String         
  node_name                 String?        
  status                    String?        
  execution_order           Int            
  input_data                String?        
  output_data               String?        
  config_data               String?        
  started_at                DateTime?      
  completed_at              DateTime?      
  timeout_at                DateTime?      
  duration_ms               Int?           
  execution_log             String?        
  error_message             String?        
  error_details             String?        
  debug_info                String?        
  retry_count               Int?           
  max_retries               Int?           
  retry_delay               Int?           
  dependencies              String?        
  dependents                String?        
  metadata                  String?        
  created_at                DateTime?       @default(now())
  updated_at                DateTime?       @default(now())
}

model node_templates {
  id                        String          @id
  name                      String         
  description               String?        
  type                      String         
  category                  String?        
  code_template             String         
  input_schema              String         
  output_schema             String         
  parameters_schema         String?        
  icon                      String?        
  color                     String?        
  documentation             String?        
  examples                  String?        
  is_system                 Boolean?       
  is_active                 Boolean?       
  created_at                DateTime?       @default(now())}

model nodes {
  id                        String          @id
  name                      String         
  description               String?        
  type                      String         
  category                  String?        
  user_id                   String         
  workspace_id              String?        
  is_public                 Boolean?       
  status                    String?        
  code_template             String         
  input_schema              String         
  output_schema             String         
  parameters_schema         String?        
  version                   String?        
  icon                      String?        
  color                     String?        
  documentation             String?        
  examples                  String?        
  downloads_count           Int?           
  usage_count               Int?           
  rating_average            Int?           
  rating_count              Int?           
  created_at                DateTime?       @default(now())
  updated_at                DateTime?       @default(now())}

model password_reset_tokens {
  id                        String          @id
  token                     String         
  user_id                   String         
  expires_at                DateTime       
  is_used                   Boolean?       
  created_at                DateTime?       @default(now())

model project_collaborators {
  id                        Int             @id @default(autoincrement())
  project_id                Int            
  user_id                   Int            
  permissions               String?        
  added_by                  Int            
  added_at                  DateTime?       @default(now())}

model project_comments {
  id                        Int             @id @default(autoincrement())
  project_id                Int            
  user_id                   Int            
  content                   String         
  node_id                   String?        
  position_x                String?        
  position_y                String?        
  is_resolved               Boolean?       
  resolved_by               Int?           
  resolved_at               DateTime?      
  created_at                DateTime?       @default(now())
  updated_at                DateTime?       @default(now())
}

model project_versions {
  id                        Int             @id @default(autoincrement())
  project_id                Int            
  version                   String         
  workflow_data             String?        
  description               String?        
  created_by                Int            
  created_at                DateTime?       @default(now())
}

model refresh_tokens {
  id                        String          @id
  token                     String         
  user_id                   String         
  expires_at                DateTime       
  is_revoked                Boolean?       
  created_at                DateTime?       @default(now())

model report_executions {
  id                        Int             @id @default(autoincrement())
  report_id                 Int            
  status                    String?        
  result_data               String?        
  error_message             String?        
  started_at                DateTime?       @default(now())
  completed_at              DateTime?      
}

model system_performance_metrics {
  id                        Int             @id @default(autoincrement())
  metric_name               String         
  metric_type               String         
  service                   String         
  environment               String         
  value                     Float          
  unit                      String?        
  tags                      String?        
  timestamp                 DateTime       
}

model template_collections {
  id                        Int             @id @default(autoincrement())
  collection_id             String         
  name                      String         
  description               String?        
  creator_id                Int            
  is_public                 Boolean?       
  is_featured               Boolean?       
  template_ids              String         
  tags                      String?        
  thumbnail_url             String?        
  view_count                Int?           
  follow_count              Int?           
  created_at                DateTime?       @default(now())
  updated_at                DateTime?       @default(now())}

model template_downloads {
  id                        Int             @id @default(autoincrement())
  template_id               Int            
  user_id                   Int            
  download_type             String?        
  ip_address                String?        
  user_agent                String?        
  template_version          String?        
  downloaded_at             DateTime?       @default(now())
}

model template_favorites {
  id                        Int             @id @default(autoincrement())
  template_id               Int            
  user_id                   Int            
  notes                     String?        
  created_at                DateTime?       @default(now())}

model template_reviews {
  id                        Int             @id @default(autoincrement())
  template_id               Int            
  user_id                   Int            
  rating                    Int            
  title                     String?        
  comment                   String?        
  ease_of_use               Int?           
  documentation_quality     Int?           
  performance               Int?           
  value_for_money           Int?           
  is_verified_purchase      Boolean?       
  is_helpful_count          Int?           
  is_reported               Boolean?       
  version_reviewed          String?        
  created_at                DateTime?       @default(now())
  updated_at                DateTime?       @default(now())
}

model template_usage {
  id                        Int             @id @default(autoincrement())
  template_id               Int            
  user_id                   Int            
  workflow_id               Int?           
  usage_type                String         
  success                   Boolean?       
  template_version          String?        
  modifications_made        String?        
  execution_time            Int?           
  ip_address                String?        
  user_agent                String?        
  used_at                   DateTime?       @default(now())
}

model user_behavior_metrics {
  id                        Int             @id @default(autoincrement())
  user_id                   Int            
  date                      DateTime       
  period_type               String         
  session_count             Int            
  total_session_duration    Int            
  avg_session_duration      Float          
  page_views                Int            
  unique_pages_visited      Int            
  workflows_created         Int            
  workflows_executed        Int            
  components_used           Int            
  collaborations_initiated  Int            
  marketplace_purchases     Int            
  revenue_generated         Float          
  components_published      Int            
  error_count               Int            
  support_tickets           Int            
  feature_requests          Int            
  engagement_score          Float          
  satisfaction_score        Float          
  value_score               Float          
  created_at                DateTime       
  updated_at                DateTime       
}

model user_insights {
  id                        Int             @id @default(autoincrement())
  user_id                   Int            
  insight_type              String         
  category                  String         
  priority                  String         
  title                     String         
  description               String         
  recommendation            String?        
  supporting_data           String?        
  confidence_score          Float          
  suggested_action          String?        
  action_url                String?        
  action_data               String?        
  is_read                   Boolean        
  is_dismissed              Boolean        
  is_acted_upon             Boolean        
  user_feedback             String?        
  expires_at                DateTime?      
  is_evergreen              Boolean        
  created_at                DateTime       
  read_at                   DateTime?      
  acted_at                  DateTime?      
}

model user_variables {
  id                        Int             @id @default(autoincrement())
  user_id                   Int            
  key                       String         
  value                     String         
  description               String?        
  is_encrypted              Boolean        
  is_active                 Boolean        
  category                  String?        
  created_at                DateTime       
  updated_at                DateTime       
}

model users {
  id                        String          @id
  email                     String         
  password_hash             String         
  first_name                String?        
  last_name                 String?        
  avatar_url                String?        
  is_active                 Boolean?       
  is_verified               Boolean?       
  role                      String?        
  subscription_plan         String?        
  preferences               String?        
  created_at                DateTime?       @default(now())
  updated_at                DateTime?       @default(now())

model workflow_connections {
  id                        String          @id
  workflow_id               String         
  source_node_id            String         
  target_node_id            String         
  source_port               String?        
  target_port               String?        
  created_at                DateTime?       @default(now())}

model workflow_executions {
  id                        Int             @id @default(autoincrement())
  execution_id              String         
  workflow_id               Int            
  user_id                   Int            
  status                    String?        
  priority                  Int?           
  input_data                String?        
  output_data               String?        
  context_data              String?        
  variables                 String?        
  total_nodes               Int?           
  completed_nodes           Int?           
  failed_nodes              Int?           
  progress_percentage       Int?           
  started_at                DateTime?      
  completed_at              DateTime?      
  timeout_at                DateTime?      
  estimated_duration        Int?           
  actual_duration           Int?           
  execution_log             String?        
  error_message             String?        
  error_details             String?        
  debug_info                String?        
  retry_count               Int?           
  max_retries               Int?           
  auto_retry                Boolean?       
  notify_on_completion      Boolean?       
  notify_on_failure         Boolean?       
  tags                      String?        
  metadata                  String?        
  created_at                DateTime?       @default(now())
  updated_at                DateTime?       @default(now())}

model workflow_nodes {
  id                        String          @id
  workflow_id               String         
  node_id                   String         
  instance_name             String?        
  position_x                Int            
  position_y                Int            
  configuration             String?        
  created_at                DateTime?       @default(now())}

model workflow_templates {
  id                        Int             @id @default(autoincrement())
  template_id               String         
  name                      String         
  title                     String         
  description               String         
  short_description         String?        
  author_id                 Int            
  original_workflow_id      Int?           
  category                  String         
  tags                      String?        
  status                    String?        
  is_public                 Boolean?       
  is_featured               Boolean?       
  is_verified               Boolean?       
  license_type              String?        
  price                     Float?         
  workflow_data             String         
  nodes_data                String         
  connections_data          String?        
  required_variables        String?        
  optional_variables        String?        
  default_config            String?        
  version                   String?        
  compatibility_version     String?        
  estimated_duration        Int?           
  complexity_level          Int?           
  download_count            Int?           
  usage_count               Int?           
  rating_average            Float?         
  rating_count              Int?           
  view_count                Int?           
  keywords                  String?        
  use_cases                 String?        
  industries                String?        
  thumbnail_url             String?        
  preview_images            String?        
  demo_video_url            String?        
  documentation             String?        
  setup_instructions        String?        
  changelog                 String?        
  support_email             String?        
  repository_url            String?        
  documentation_url         String?        
  created_at                DateTime?       @default(now())
  updated_at                DateTime?       @default(now())
  published_at              DateTime?      
  last_used_at              DateTime?}

model workflows {
  id                        String          @id
  name                      String         
  description               String?        
  user_id                   String         
  workspace_id              String?        
  is_public                 Boolean?       
  category                  String?        
  tags                      String?        
  version                   String?        
  status                    String?        
  definition                String         
  thumbnail_url             String?        
  downloads_count           Int?           
  rating_average            Int?           
  rating_count              Int?           
  execution_count           Int?           
  last_executed_at          DateTime?      
  created_at                DateTime?       @default(now())
  updated_at                DateTime?       @default(now())}

model workspace_activities {
  id                        Int             @id @default(autoincrement())
  workspace_id              Int            
  project_id                Int?           
  user_id                   Int            
  action                    String         
  target_type               String?        
  target_id                 Int?           
  metadata                  String?        
  created_at                DateTime?       @default(now())
}

model workspace_invitations {
  id                        Int             @id @default(autoincrement())
  workspace_id              Int            
  email                     String         
  role                      String?        
  permissions               String?        
  token                     String         
  invited_by                Int            
  status                    String?        
  expires_at                DateTime       
  created_at                DateTime?       @default(now())
  responded_at              DateTime?}

model workspace_members {
  id                        String          @id
  workspace_id              String         
  user_id                   String         
  role                      String?        
  permissions               String?        
  joined_at                 DateTime?       @default(now())}

model workspace_projects {
  id                        Int             @id @default(autoincrement())
  workspace_id              Int            
  name                      String         
  description               String?        
  workflow_data             String?        
  status                    String?        
  owner_id                  Int            
  created_at                DateTime?       @default(now())
  updated_at                DateTime?       @default(now())
}

model workspaces {
  id                        String          @id
  name                      String         
  description               String?        
  owner_id                  String         
  is_public                 Boolean?       
  settings                  String?        
  created_at                DateTime?       @default(now())
  updated_at                DateTime?       @default(now())}

