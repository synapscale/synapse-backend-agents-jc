---
description: "Regras para gerenciamento de arquivos JSON de relatÃ³rios e configuraÃ§Ãµes"
globs: ["**/*.json"]
alwaysApply: true
---
# ğŸ“Š REGRA CRÃTICA - GERENCIAMENTO DE ARQUIVOS JSON DE RELATÃ“RIOS

## **ğŸš¨ REGRA ABSOLUTA: REUTILIZAR ANTES DE CRIAR**

**CONTEXTO**: O repositÃ³rio estÃ¡ sendo poluÃ­do com arquivos JSON de relatÃ³rios, configuraÃ§Ãµes e anÃ¡lises duplicados e abandonados. Precisamos manter organizaÃ§Ã£o e reutilizar estruturas existentes para evitar confusÃ£o e redundÃ¢ncia.

**âŒ PROIBIDO:**
- Criar novos arquivos .json de relatÃ³rios sem verificar se jÃ¡ existe similar
- Deixar arquivos JSON na raiz do repositÃ³rio quando podem estar em pastas especÃ­ficas
- Abandonar arquivos JSON apÃ³s uso sem limpeza ou consolidaÃ§Ã£o
- Duplicar estruturas de dados em novos arquivos JSON
- Criar relatÃ³rios JSON pontuais sem plano de consolidaÃ§Ã£o/limpeza

**âœ… OBRIGATÃ“RIO:**

## 1. **VERIFICAÃ‡ÃƒO ANTES DE CRIAR**

```bash
# âœ… SEMPRE verificar arquivos JSON existentes primeiro
ls -la *.json | grep -E "(report|test|analysis|config|validation|structure|performance)"
find . -name "*.json" | grep -E "(report|test|analysis|config|validation|structure|performance)"
find . -name "*.json" -exec grep -l "similar_structure" {} \;
```

## 2. **PRIORIDADE DE REUTILIZAÃ‡ÃƒO**

```json
// âœ… SEMPRE otimizar arquivos JSON existentes ao invÃ©s de criar novos
// Exemplo: Se existe test_config.json, EDITAR ele para adicionar novas configuraÃ§Ãµes
// ao invÃ©s de criar new_test_configuration.json

// âŒ ERRADO: Criar novo arquivo JSON
// create_file("new_analysis_report.json", content="{...}")

// âœ… CORRETO: Otimizar existente
// edit_file("reports/analysis_report.json", 
//           old_str='"existing_data": {...}', 
//           new_str='"existing_data": {...},\n  "new_analysis": {...}')
```

## 3. **ORGANIZAÃ‡ÃƒO OBRIGATÃ“RIA**

```text
âœ… ESTRUTURA CORRETA:
reports/
â”œâ”€â”€ test-results/           # Resultados de testes automatizados
â”œâ”€â”€ analysis/               # AnÃ¡lises de cÃ³digo e estrutura
â”œâ”€â”€ performance/            # RelatÃ³rios de performance
â”œâ”€â”€ validation/             # RelatÃ³rios de validaÃ§Ã£o
â”œâ”€â”€ config/                 # ConfiguraÃ§Ãµes de ferramentas
â””â”€â”€ temp/                   # RelatÃ³rios temporÃ¡rios

config/
â”œâ”€â”€ test/                   # ConfiguraÃ§Ãµes de teste
â”œâ”€â”€ build/                  # ConfiguraÃ§Ãµes de build
â””â”€â”€ deployment/             # ConfiguraÃ§Ãµes de deploy

âŒ EVITAR NA RAIZ:
â”œâ”€â”€ test_report.json        # Deve estar em reports/test-results/
â”œâ”€â”€ analysis_*.json         # Deve estar em reports/analysis/
â”œâ”€â”€ performance_*.json      # Deve estar em reports/performance/
â”œâ”€â”€ validation_*.json       # Deve estar em reports/validation/
â”œâ”€â”€ *_config.json          # Deve estar em config/categoria/
```

## 4. **ARQUIVOS JSON PONTUAIS - CONSOLIDAÃ‡ÃƒO OBRIGATÃ“RIA**

```json
// âœ… Para arquivos JSON temporÃ¡rios/pontuais:

// 1. Criar em local adequado
// reports/temp/temp_database_analysis_20250107.json

// 2. Usar com metadados claros
{
  "_metadata": {
    "type": "TEMPORARY_REPORT",
    "created": "2025-01-07",
    "purpose": "AnÃ¡lise pontual da estrutura do banco de dados",
    "consolidate_to": "reports/analysis/database_structure.json",
    "delete_after": "2025-01-14",
    "status": "pending_consolidation"
  },
  "analysis_data": {
    // dados da anÃ¡lise...
  }
}

// 3. SEMPRE consolidar ou deletar apÃ³s uso
// TODO: Consolidar dados em relatÃ³rio definitivo âœ…
```

## 5. **WORKFLOW OBRIGATÃ“RIO**

```bash
# âœ… Antes de criar qualquer arquivo JSON de relatÃ³rio:

# 1. Verificar se existe similar
echo "ğŸ” Verificando arquivos JSON existentes..."
find . -name "*.json" -type f | grep -E "(report|test|analysis|config|validation)" | head -15

# 2. Se existe similar, EDITAR ao invÃ©s de criar novo
echo "âœï¸ Editando arquivo JSON existente ao invÃ©s de criar novo..."

# 3. Se nÃ£o existe, criar em local correto
echo "ğŸ“ Criando em pasta adequada (reports/, config/, etc.)"

# 4. Para JSONs pontuais, adicionar metadados de consolidaÃ§Ã£o
echo "ğŸ—‚ï¸ Adicionando _metadata para consolidaÃ§Ã£o posterior..."

# 5. ApÃ³s uso, SEMPRE consolidar ou limpar
echo "âœ… Consolidando arquivos JSON temporÃ¡rios..."
```

## 6. **ARQUIVOS JSON PERMITIDOS NA RAIZ (APENAS)**

```json
// âœ… ÃšNICOS arquivos JSON permitidos na raiz (casos excepcionais):
{
  "ALLOWED_ROOT_JSON": [
    "package.json",              // ConfiguraÃ§Ã£o do Node.js
    "package-lock.json",         // Lock do Node.js
    "pyproject.toml",            // ConfiguraÃ§Ã£o Python (nÃ£o JSON, mas similar)
    "current_openapi.json",      // Schema OpenAPI atual
    "current_openapi.json.backup", // Backup do schema (temporÃ¡rio)
    "tasks.json",                // ConfiguraÃ§Ã£o de tasks do projeto
    "tsconfig.json",             // ConfiguraÃ§Ã£o TypeScript (se aplicÃ¡vel)
    "jest.config.json"           // ConfiguraÃ§Ã£o de testes (se aplicÃ¡vel)
  ]
}

// âŒ Qualquer outro arquivo JSON DEVE estar em pastas especÃ­ficas
// âš ï¸  Backups e relatÃ³rios temporÃ¡rios devem ser movidos apÃ³s consolidaÃ§Ã£o
```

## 7. **VERIFICAÃ‡ÃƒO PRÃ‰-COMMIT**

```bash
# âœ… Checklist obrigatÃ³rio antes de commit:
echo "ğŸ“‹ VerificaÃ§Ãµes de arquivos JSON:"
echo "- [ ] NÃ£o criei JSON duplicado quando jÃ¡ existia similar?"
echo "- [ ] Arquivos JSON estÃ£o em pastas adequadas e nÃ£o na raiz?"
echo "- [ ] JSONs pontuais tÃªm _metadata para consolidaÃ§Ã£o?"
echo "- [ ] Reutilizei estruturas JSON existentes ao mÃ¡ximo?"
echo "- [ ] Arquivos JSON temporÃ¡rios foram consolidados apÃ³s uso?"
echo "- [ ] NÃ£o hÃ¡ estruturas contraditÃ³rias entre arquivos JSON?"
echo "- [ ] Schemas JSON estÃ£o consistentes entre arquivos?"
```

## 8. **PENALIDADES POR VIOLAÃ‡ÃƒO**
- **1Âª violaÃ§Ã£o**: Refatorar/consolidar imediatamente
- **2Âª violaÃ§Ã£o**: Revisar toda estrutura de relatÃ³rios JSON
- **3Âª violaÃ§Ã£o**: ReorganizaÃ§Ã£o completa dos arquivos JSON

## **ğŸ¯ REGRA DE OURO:**
> "Se existe similar, EDITE. Se nÃ£o existe, crie em pasta adequada. Se Ã© pontual, CONSOLIDE apÃ³s uso."

## 9. **EXEMPLOS PRÃTICOS**

### âœ… CORRETO - Reutilizando arquivo JSON existente
```json
// CenÃ¡rio: Preciso adicionar novos resultados de teste
// Encontrei: reports/test-results/api_endpoints_test.json

// Ao invÃ©s de criar novo, EDITO o existente:
// edit_file("reports/test-results/api_endpoints_test.json",
//     old_str='"test_summary": {...}',
//     new_str='"test_summary": {...},\n  "new_endpoints_test": {...}')

{
  "test_summary": {
    "total_tests": 150,
    "passed": 147,
    "failed": 3
  },
  "new_endpoints_test": {
    "llm_endpoints": {
      "tested": 25,
      "passed": 24,
      "failed": 1
    }
  }
}
```

### âŒ INCORRETO - Criando desnecessariamente
```json
// âŒ NÃƒO FAZER: Criar llm_test_results.json quando jÃ¡ existe api_endpoints_test.json
// create_file("llm_test_results.json", content="{...}")
```

### âœ… CORRETO - Arquivo JSON pontual com consolidaÃ§Ã£o
```json
// Arquivo para anÃ¡lise especÃ­fica e temporÃ¡ria
// reports/temp/database_performance_analysis_2025_01_07.json
{
  "_metadata": {
    "type": "TEMPORARY_ANALYSIS",
    "created": "2025-01-07T10:30:00Z",
    "purpose": "AnÃ¡lise pontual de performance do banco de dados",
    "consolidate_to": "reports/performance/database_metrics.json",
    "delete_after": "2025-01-14",
    "author": "system_analysis"
  },
  "performance_data": {
    "query_times": {...},
    "connection_pool": {...}
  }
}

// ApÃ³s anÃ¡lise:
// 1. Extrair insights importantes
// 2. Consolidar em reports/performance/database_metrics.json
// 3. Deletar arquivo temporÃ¡rio
```

### âœ… CORRETO - ConsolidaÃ§Ã£o de mÃºltiplos arquivos JSON
```json
// Se existem: test_results_api.json, test_results_llm.json, test_results_auth.json
// Consolidar em: reports/test-results/comprehensive_test_results.json

{
  "_metadata": {
    "type": "CONSOLIDATED_REPORT",
    "consolidated_from": [
      "test_results_api.json",
      "test_results_llm.json", 
      "test_results_auth.json"
    ],
    "consolidated_date": "2025-01-07",
    "next_update": "2025-01-14"
  },
  "api_tests": { /* dados do test_results_api.json */ },
  "llm_tests": { /* dados do test_results_llm.json */ },
  "auth_tests": { /* dados do test_results_auth.json */ }
}
```

## 10. **COMANDOS ÃšTEIS PARA VERIFICAÃ‡ÃƒO**

```bash
# Listar todos os arquivos JSON na raiz (para limpeza)
ls -la *.json | grep -vE "^(package|package-lock|current_openapi|tasks|tsconfig|jest\.config)\.json$"

# Encontrar arquivos JSON similares por estrutura
find . -name "*.json" -exec grep -l "similar_key_structure" {} \;

# Verificar estrutura de reports/
tree reports/ -I "*.tmp" -I "node_modules"

# Contar arquivos JSON duplicados/similares por tipo
find . -name "*test*.json" -o -name "*report*.json" -o -name "*analysis*.json" | wc -l

# Buscar arquivos JSON Ã³rfÃ£os (sem referÃªncias)
find . -name "*.json" -type f | while read file; do
  if ! grep -r "$(basename "$file")" --exclude="*.json" . >/dev/null 2>&1; then
    echo "Ã“rfÃ£o: $file"
  fi
done

# Verificar JSON vÃ¡lidos
find . -name "*.json" -exec python3 -m json.tool {} \; >/dev/null 2>&1 || echo "JSON invÃ¡lido encontrado"

# Identificar arquivos JSON Ã³rfÃ£os na raiz que deveriam estar em pastas
find . -maxdepth 1 -name "*.json" -type f | grep -vE "^./(package|package-lock|current_openapi|tasks|tsconfig|jest\.config)\.json$"
```

## 11. **PADRÃ•ES DE NOMENCLATURA**

### âœ… NOMENCLATURA CORRETA
```text
reports/
â”œâ”€â”€ test-results/
â”‚   â”œâ”€â”€ api-endpoints.json       # NÃ£o "API_TEST_RESULTS.json"
â”‚   â”œâ”€â”€ authentication.json     # NÃ£o "AUTH_TEST_REPORT.json"
â”‚   â””â”€â”€ performance-tests.json  # Usar kebab-case
â”œâ”€â”€ analysis/
â”‚   â”œâ”€â”€ code-structure.json     # NÃ£o "CODE_ANALYSIS.json"
â”‚   â”œâ”€â”€ dependency-check.json   # NÃ£o "DEPS_REPORT.json"
â”‚   â””â”€â”€ security-scan.json      # EspecÃ­fico e claro
â””â”€â”€ validation/
    â”œâ”€â”€ model-validation.json   # NÃ£o "MODELS_CHECK.json"
    â”œâ”€â”€ api-compliance.json     # NÃ£o "API_VALIDATION.json"
    â””â”€â”€ database-integrity.json # NÃ£o "DB_CHECK.json"
```

### âŒ NOMENCLATURA INCORRETA
```text
# Evitar nomes genÃ©ricos ou redundantes:
- report.json                   # Muito genÃ©rico
- test_results.json            # Deve ser especÃ­fico
- analysis_data.json           # Deve indicar tipo de anÃ¡lise
- temp_file.json              # Usar convenÃ§Ã£o de temporÃ¡rios
- backup_config.json          # NÃ£o deixar backups no repo
- new_report_2025.json        # Evitar datas/versÃµes no nome
```

## 12. **TEMPLATE PARA NOVOS ARQUIVOS JSON**

```json
{
  "_metadata": {
    "version": "1.0",
    "type": "report|config|analysis|validation",
    "created": "2025-01-07T10:30:00Z",
    "updated": "2025-01-07T10:30:00Z",
    "purpose": "DescriÃ§Ã£o especÃ­fica do propÃ³sito",
    "author": "system|user|tool_name",
    "schema_version": "1.0",
    "related_files": ["arquivo1.json", "arquivo2.json"]
  },
  "summary": {
    "total_items": 0,
    "success_count": 0,
    "error_count": 0,
    "warnings": []
  },
  "data": {
    // Estrutura principal dos dados
  },
  "errors": [
    // Lista de erros encontrados
  ],
  "next_steps": [
    // AÃ§Ãµes recomendadas
  ]
}
```

## 13. **PROCESSO DE MANUTENÃ‡ÃƒO**

```bash
# RevisÃ£o semanal de arquivos JSON
# 1. Verificar JSONs Ã³rfÃ£os
find . -name "*.json" -atime +7

# 2. Consolidar temporÃ¡rios
find reports/temp/ -name "*.json" -mtime +7

# 3. Validar estrutura JSON
find . -name "*.json" -exec python3 -c "import json; json.load(open('{}'))" \; 2>/dev/null

# 4. Atualizar metadados
grep -r "_metadata" --include="*.json" . | grep "pending_consolidation"
```

## 14. **PROCESSO DE LIMPEZA AUTOMÃTICA**

```bash
# Script de limpeza semanal recomendado
#!/bin/bash

echo "ğŸ§¹ Iniciando limpeza de arquivos JSON..."

# 1. Identificar arquivos JSON Ã³rfÃ£os na raiz
echo "ğŸ“‹ Arquivos JSON Ã³rfÃ£os na raiz:"
find . -maxdepth 1 -name "*.json" -type f | grep -vE "^./(package|package-lock|current_openapi|tasks|tsconfig|jest\.config)\.json$"

# 2. Listar arquivos JSON temporÃ¡rios antigos
echo "â° Arquivos JSON temporÃ¡rios antigos (>7 dias):"
find reports/temp/ -name "*.json" -mtime +7 2>/dev/null || echo "Pasta reports/temp/ nÃ£o existe"

# 3. Verificar arquivos JSON invÃ¡lidos
echo "âŒ Arquivos JSON com sintaxe invÃ¡lida:"
find . -name "*.json" -type f | while read file; do
  if ! python3 -m json.tool "$file" >/dev/null 2>&1; then
    echo "JSON invÃ¡lido: $file"
  fi
done

# 4. Verificar duplicaÃ§Ãµes por estrutura
echo "ğŸ” PossÃ­veis duplicaÃ§Ãµes por tipo:"
find . -name "*test*.json" -o -name "*report*.json" -o -name "*analysis*.json" | sort | uniq -c | grep -v "1 "

# 5. Verificar arquivos com metadados de consolidaÃ§Ã£o pendente
echo "ğŸ“Š Arquivos pendentes de consolidaÃ§Ã£o:"
grep -r "pending_consolidation" --include="*.json" . 2>/dev/null || echo "Nenhum arquivo pendente"

# 6. Sugerir consolidaÃ§Ãµes
echo "ğŸ’¡ SugestÃµes de consolidaÃ§Ã£o disponÃ­veis em .cursor/rules/new_json_reports.mdc"
```
